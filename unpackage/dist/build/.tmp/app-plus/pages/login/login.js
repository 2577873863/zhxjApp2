(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/login/login"],{"2c0b":function(t,e,n){},"609d":function(t,e,n){"use strict";n.r(e);var a=n("d84d"),i=n.n(a);for(var o in a)"default"!==o&&function(t){n.d(e,t,(function(){return a[t]}))}(o);e["default"]=i.a},"83be":function(t,e,n){"use strict";var a,i=function(){var t=this,e=t.$createElement;t._self._c},o=[];n.d(e,"b",(function(){return i})),n.d(e,"c",(function(){return o})),n.d(e,"a",(function(){return a}))},a9ab:function(t,e,n){"use strict";var a=n("2c0b"),i=n.n(a);i.a},d1b7:function(t,e,n){"use strict";(function(t){n("706c"),n("921b");a(n("66fd"));var e=a(n("df61"));function a(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,n("6e42")["createPage"])},d84d:function(t,e,n){"use strict";(function(t,a){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=s(n("4795")),o=n("cb3b"),r=n("ff50");function s(t){return t&&t.__esModule?t:{default:t}}function u(t,e,n,a,i,o,r){try{var s=t[o](r),u=s.value}catch(c){return void n(c)}s.done?e(u):Promise.resolve(u).then(a,i)}function c(t){return function(){var e=this,n=arguments;return new Promise((function(a,i){var o=t.apply(e,n);function r(t){u(o,a,i,r,s,"next",t)}function s(t){u(o,a,i,r,s,"throw",t)}r(void 0)}))}}var d=!1,l={data:function(){return{username:"15128098798",password:"123456",GpsDO:{}}},onLoad:function(){this.handleNotice(),t.getStorageSync("token")&&t.redirectTo({url:"../index/index"})},methods:{doLogin:function(){var e=this;return c(i.default.mark((function n(){var o,s,u,c,l,f;return i.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return a("log","aaa"," at pages\\login\\login.vue:41"),o=plus.push.getClientInfo(),s=o.clientid,u=e.username,c=e.password,l={sysname:u,password:c,clientId:s},a("log",JSON.stringify(l)," at pages\\login\\login.vue:49"),n.next=7,(0,r.apiLogin)(l);case 7:f=n.sent,a("log","login result == >",JSON.stringify(f)," at pages\\login\\login.vue:51"),t.setStorageSync("accessToken",f.data.data.accessToken),t.setStorageSync("clientId",s),d&&setInterval((function(){e.doLocation()}),2e3),t.switchTab({url:"../index/index"});case 13:case"end":return n.stop()}}),n)})))()},doLocation:function(){var e=this;t.getLocation({type:"wgs84",altitude:!0,geocode:!0,success:function(t){var n=t.address,a=(n.country,n.province),i=n.city,o=n.district,r=n.street,s=n.streetNum,u={sys_name:e.username,longitude:t.longitude,latitude:t.latitude,address:a+i+o+r+s,type:t.type,speed:t.speed,accuracy:t.accuracy};e.createGPSInfo(u)},fail:function(e){a("log","定位失败",e," at pages\\login\\login.vue:84"),t.showToast({title:"定位失败",icon:"none"})}})},createGPSInfo:function(t){var e=this;return c(i.default.mark((function n(){var s,u,c,d,l,f;return i.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(!(0,o.isEmptyObj)(e.GpsDO)){n.next=5;break}a("log","第一次定位"," at pages\\login\\login.vue:94"),e.GpsDO=t,n.next=9;break;case 5:if(s=t.longitude,u=t.latitude,c=e.GpsDO,d=c.longitude,l=c.latitude,s!=d||u!=l){n.next=9;break}return n.abrupt("return");case 9:return e.GpsDO=t,n.next=12,(0,r.apiCreateGps)({GpsDO:JSON.stringify(t)});case 12:f=n.sent,wx.showToast({title:f.data.errmsg+JSON.stringify(t),icon:"none",mask:!0,duration:1e3});case 14:case"end":return n.stop()}}),n)})))()},handleNotice:function(e){var n=t.getSystemInfoSync();if("android"===n.platform){var i=plus.android.importClass("android.content.Context"),o=plus.android.importClass("android.location.LocationManager"),r=plus.android.runtimeMainActivity(),s=r.getSystemService(i.LOCATION_SERVICE);s.isProviderEnabled(o.GPS_PROVIDER)||t.showModal({title:"提示",content:"请打开定位服务功能",showCancel:!1,success:function(){if(s.isProviderEnabled(o.GPS_PROVIDER))a("log","GPS功能已开启"," at pages\\login\\login.vue:136");else{var t=plus.android.importClass("android.content.Intent"),e=plus.android.importClass("android.provider.Settings"),n=new t(e.ACTION_LOCATION_SOURCE_SETTINGS);r.startActivity(n)}}})}}}};e.default=l}).call(this,n("6e42")["default"],n("0de9")["default"])},df61:function(t,e,n){"use strict";n.r(e);var a=n("83be"),i=n("609d");for(var o in i)"default"!==o&&function(t){n.d(e,t,(function(){return i[t]}))}(o);n("a9ab");var r,s=n("f0c5"),u=Object(s["a"])(i["default"],a["b"],a["c"],!1,null,"0420c99a",null,!1,a["a"],r);e["default"]=u.exports}},[["d1b7","common/runtime","common/vendor"]]]);